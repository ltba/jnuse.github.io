<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="author" content="聆听·彼岸"><title>Python操作键鼠与剪贴板 | 聆听·彼岸的博客|闲人记闲文闲事 - 彼岸少年</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="keywords" content="笔记,python,"><meta name="description" content="欢迎来到聆听·彼岸的博客，&lt;br&gt;这里记录着我的点点滴滴。&lt;br&gt;I have a dream.&lt;br&gt;And I will achieve it.&lt;br&gt;我有一个梦想。&lt;br&gt;而且我会实现它。"><link rel="icon" type="image/png" sizes="32x32" href="/img/fa/main.jpg?v=5.1.4"><script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script><script src="/js/rikoHead.js"></script><script src="/music/tplayer.js"></script><script src="/music/music.js"></script><script src="/randomimg.js"></script><link href="https://cdn.bootcdn.net/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"><link rel="stylesheet" href="/css/riko.css"><link rel="stylesheet" href="/css/sunburst.css"><link href="/music/tplayer.css" rel="stylesheet"><meta name="generator" content="Hexo 6.3.0"></head><body><div class="bg" id="bg"><div class="card no-select"><p class="head_name">Hi，聆听·彼岸</p><br><br><div class="subtitle"><i title="是真的！">听说，你是我最遥不可及的梦。<br>What should I do?<br>What should I do?<br>I think I'm going to fall in love with myself.<br></i></div></div></div><div class="GalMenu GalDropDown" id="rightmenu"><div class="circle" id="gal"><div class="ring"><a href="JavaScript:void(0)" style="top:15%;left:50%" onclick="this.href=&#39;/&#39;" class="menuItem">首页</a> <a href="JavaScript:void(0)" style="top:35%;left:15%" onclick="this.href=&#39;/长话短说/&#39;" class="menuItem">长话短说</a> <a href="JavaScript:void(0)" style="top:70%;left:15%" onclick="this.href=&#39;/简约导航/&#39;" class="menuItem">简约导航</a> <a href="JavaScript:void(0)" style="top:85%;left:50%" class="menuItem">搜索</a> <a href="JavaScript:void(0)" style="top:70%;left:85%" onclick="this.href=&#39;/friends/&#39;" class="menuItem">友链</a> <a href="JavaScript:void(0)" style="top:35%;left:85%" onclick="this.href=&#39;/archives/&#39;" class="menuItem">归档</a></div></div></div><header><ul class="n no-select"><a href="/"><li class="na" title="首页"><i class="fa fa-fw fa-home"></i></li></a><a href="/about/"><li class="na" title="关于"><i class="fa fa-fw fa-user"></i></li></a><a href="/tags/"><li class="na" title="标签"><i class="fa fa-fw fa-tags"></i></li></a><a href="/categories/"><li class="na" title="分类"><i class="fa fa-fw fa-th"></i></li></a><a href="/archives/"><li class="na" title="归档"><i class="fa fa-fw fa-archive"></i></li></a><a href="/friends/"><li class="na" title="友链"><i class="fa fa-fw fa-users"></i></li></a></ul></header><main id="main"><div class="post"><h2 class="post-title">Python操作键鼠与剪贴板</h2><span></span> <span class="post-time"><i class="fa fa-calendar-o"></i> 发表于 2022-10-23</span>| <span class="post-categories"><i class="fa fa-folder-o"></i> 分类于 <a href="/categories/%E7%AC%94%E8%AE%B0/">笔记</a> </span>| <span class="post-tags"><i class="fa fa-tag"></i> <a href="/tags/python/">python</a> </span>| <span class="post-comment"><i class="fa fa-comment-o"></i> 评论数</span><div class="post-article"><h2 id="Python模拟按键"><a href="#Python模拟按键" class="headerlink" title="Python模拟按键"></a>Python模拟按键</h2><h3 id="可以调用win32api来实现"><a href="#可以调用win32api来实现" class="headerlink" title="可以调用win32api来实现"></a>可以调用win32api来实现</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># pip install pypiwin32 </span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> win32con</span><br><span class="line"><span class="keyword">import</span> win32api</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">key_map = &#123;</span><br><span class="line">    <span class="string">&quot;0&quot;</span>: <span class="number">49</span>, <span class="string">&quot;1&quot;</span>: <span class="number">50</span>, <span class="string">&quot;2&quot;</span>: <span class="number">51</span>, <span class="string">&quot;3&quot;</span>: <span class="number">52</span>, <span class="string">&quot;4&quot;</span>: <span class="number">53</span>, <span class="string">&quot;5&quot;</span>: <span class="number">54</span>, <span class="string">&quot;6&quot;</span>: <span class="number">55</span>, <span class="string">&quot;7&quot;</span>: <span class="number">56</span>, <span class="string">&quot;8&quot;</span>: <span class="number">57</span>, <span class="string">&quot;9&quot;</span>: <span class="number">58</span>,</span><br><span class="line">    <span class="string">&quot;A&quot;</span>: <span class="number">65</span>, <span class="string">&quot;B&quot;</span>: <span class="number">66</span>, <span class="string">&quot;C&quot;</span>: <span class="number">67</span>, <span class="string">&quot;D&quot;</span>: <span class="number">68</span>, <span class="string">&quot;E&quot;</span>: <span class="number">69</span>, <span class="string">&quot;F&quot;</span>: <span class="number">70</span>, <span class="string">&quot;G&quot;</span>: <span class="number">71</span>, <span class="string">&quot;H&quot;</span>: <span class="number">72</span>, <span class="string">&quot;I&quot;</span>: <span class="number">73</span>, <span class="string">&quot;J&quot;</span>: <span class="number">74</span>,</span><br><span class="line">    <span class="string">&quot;K&quot;</span>: <span class="number">75</span>, <span class="string">&quot;L&quot;</span>: <span class="number">76</span>, <span class="string">&quot;M&quot;</span>: <span class="number">77</span>, <span class="string">&quot;N&quot;</span>: <span class="number">78</span>, <span class="string">&quot;O&quot;</span>: <span class="number">79</span>, <span class="string">&quot;P&quot;</span>: <span class="number">80</span>, <span class="string">&quot;Q&quot;</span>: <span class="number">81</span>, <span class="string">&quot;R&quot;</span>: <span class="number">82</span>, <span class="string">&quot;S&quot;</span>: <span class="number">83</span>, <span class="string">&quot;T&quot;</span>: <span class="number">84</span>,</span><br><span class="line">    <span class="string">&quot;U&quot;</span>: <span class="number">85</span>, <span class="string">&quot;V&quot;</span>: <span class="number">86</span>, <span class="string">&quot;W&quot;</span>: <span class="number">87</span>, <span class="string">&quot;X&quot;</span>: <span class="number">88</span>, <span class="string">&quot;Y&quot;</span>: <span class="number">89</span>, <span class="string">&quot;Z&quot;</span>: <span class="number">90</span></span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">key_down</span>(<span class="params">key</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    函数功能：按下按键</span></span><br><span class="line"><span class="string">    参    数：key:按键值</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    key = key.upper()</span><br><span class="line">    vk_code = key_map[key]</span><br><span class="line">    win32api.keybd_event(vk_code,win32api.MapVirtualKey(vk_code,<span class="number">0</span>),<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">key_up</span>(<span class="params">key</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    函数功能：抬起按键</span></span><br><span class="line"><span class="string">    参    数：key:按键值</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    key = key.upper()</span><br><span class="line">    vk_code = key_map[key]</span><br><span class="line">    win32api.keybd_event(vk_code, win32api.MapVirtualKey(vk_code, <span class="number">0</span>), win32con.KEYEVENTF_KEYUP, <span class="number">0</span>)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">key_press</span>(<span class="params">key</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    函数功能：点击按键（按下并抬起）</span></span><br><span class="line"><span class="string">    参    数：key:按键值</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    key_down(key)</span><br><span class="line">    time.sleep(<span class="number">0.02</span>)</span><br><span class="line">    key_up(key)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">move</span>(<span class="params">x, y</span>):</span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">  函数功能：移动鼠标到指定位置</span></span><br><span class="line"><span class="string">  参  数：x:x坐标</span></span><br><span class="line"><span class="string">       y:y坐标</span></span><br><span class="line"><span class="string">  &quot;&quot;&quot;</span></span><br><span class="line">  win32api.SetCursorPos((x, y))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_cur_pos</span>():</span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">  函数功能：获取当前鼠标坐标</span></span><br><span class="line"><span class="string">  &quot;&quot;&quot;</span></span><br><span class="line">  p=&#123;<span class="string">&quot;x&quot;</span>:<span class="number">0</span>,<span class="string">&quot;y&quot;</span>:<span class="number">0</span>&#125;</span><br><span class="line">  pos = win32gui.GetCursorPos()</span><br><span class="line">  p[<span class="string">&#x27;x&#x27;</span>]=pos[<span class="number">0</span>]</span><br><span class="line">  p[<span class="string">&#x27;y&#x27;</span>]=pos[<span class="number">1</span>]</span><br><span class="line">  <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">left_click</span>():</span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">  函数功能：鼠标左键点击</span></span><br><span class="line"><span class="string">  &quot;&quot;&quot;</span></span><br><span class="line">  win32api.mouse_event(win32con.MOUSEEVENTF_LEFTDOWN | win32con.MOUSEEVENTF_LEFTUP, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">right_click</span>():</span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">  函数功能：鼠标右键点击</span></span><br><span class="line"><span class="string">  &quot;&quot;&quot;</span></span><br><span class="line">  win32api.mouse_event(win32con.MOUSEEVENTF_RIGHTDOWN | win32con.MOUSEEVENTF_RIGHTUP, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">left_down</span>():</span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">  函数功能：鼠标左键按下</span></span><br><span class="line"><span class="string">  &quot;&quot;&quot;</span></span><br><span class="line">  win32api.mouse_event(win32con.MOUSEEVENTF_LEFTDOWN, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">left_up</span>():</span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">  函数功能：鼠标左键抬起</span></span><br><span class="line"><span class="string">  &quot;&quot;&quot;</span></span><br><span class="line">  win32api.mouse_event(win32con.MOUSEEVENTF_LEFTUP, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">right_down</span>():</span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">  函数功能：鼠标右键按下</span></span><br><span class="line"><span class="string">  &quot;&quot;&quot;</span></span><br><span class="line">  win32api.mouse_event(win32con.MOUSEEVENTF_RIGHTDOWN, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">right_up</span>():</span><br><span class="line">  <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">  函数功能：鼠标右键抬起</span></span><br><span class="line"><span class="string">  &quot;&quot;&quot;</span></span><br><span class="line">  win32api.mouse_event(win32con.MOUSEEVENTF_RIGHTUP, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 以上代码来自脚本之家</span></span><br></pre></td></tr></table></figure><p>也有用ctypes库的——可以调用dll</p><p>最后我看到了pykeyboard和pymouse，继续看，直接大一统PyUserInput</p><h3 id="PyUserInput"><a href="#PyUserInput" class="headerlink" title="PyUserInput"></a>PyUserInput</h3><p>安装</p><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">pip install pywin32 -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br></pre></td></tr></table></figure><p>是的，到这里，我兴致冲冲的安装了pywin32搜一下pyhook的安装，说什么不能用pip安装。<br>pyhook与Python3不兼容，要安装pyhook3。看到这里我就知道有问题了，赶紧去翻了翻PyUserInput的源代码。<br>最后在readme中找到了这样一段话</p><p>Deprecated<br>Please use Pynput instead.</p><p>What’s wrong with PyUserInput?</p><ul><li>Nobody is actively working on it</li><li>Events on Windows depend on PyHook which is dead and not compatible with Python 3</li><li>Only works with QWERTY</li><li>Inconsistent API for non-printable characters</li><li>Probably more</li></ul><p>好吧！生活总是一波三折的。</p><h3 id="Pynput"><a href="#Pynput" class="headerlink" title="Pynput"></a>Pynput</h3><figure class="highlight cmd"><table><tr><td class="code"><pre><span class="line">pip install pynput -i https://pypi.tuna.tsinghua.edu.cn/simple </span><br></pre></td></tr></table></figure><p>再翻译一下官方文档</p><h4 id="控制鼠标"><a href="#控制鼠标" class="headerlink" title="控制鼠标"></a>控制鼠标</h4><p>像这样使用：pynput.mouse.Controller</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pynput.mouse <span class="keyword">import</span> Button, Controller</span><br><span class="line"></span><br><span class="line">mouse = Controller()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取鼠标位置</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;The current pointer position is &#123;0&#125;&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">    mouse.position))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 移动鼠标</span></span><br><span class="line">mouse.position = (<span class="number">10</span>, <span class="number">20</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Now we have moved it to &#123;0&#125;&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">    mouse.position))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 相对于当前位置移动鼠标</span></span><br><span class="line">mouse.move(<span class="number">5</span>, -<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 按下和松开鼠标左键</span></span><br><span class="line">mouse.press(Button.left)</span><br><span class="line">mouse.release(Button.left)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 双击</span></span><br><span class="line">mouse.click(Button.left, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 0向下滚动两步,1向上(官方指的是(水平滚动，垂直滚动))</span></span><br><span class="line">mouse.scroll(<span class="number">0</span>, <span class="number">2</span>)</span><br></pre></td></tr></table></figure><h4 id="监听鼠标"><a href="#监听鼠标" class="headerlink" title="监听鼠标"></a>监听鼠标</h4><p>像这样使用：pynput.mouse.Listener</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pynput <span class="keyword">import</span> mouse</span><br><span class="line"></span><br><span class="line"><span class="comment"># 监听鼠标移动事件</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">on_move</span>(<span class="params">x, y</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Pointer moved to &#123;0&#125;&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">        (x, y)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 监听鼠标单击事件</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">on_click</span>(<span class="params">x, y, button, pressed</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;&#123;0&#125; at &#123;1&#125;&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">        <span class="string">&#x27;Pressed&#x27;</span> <span class="keyword">if</span> pressed <span class="keyword">else</span> <span class="string">&#x27;Released&#x27;</span>,</span><br><span class="line">        (x, y)))</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> pressed:</span><br><span class="line">        <span class="comment"># 停止监听</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 监听鼠标滚动事件</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">on_scroll</span>(<span class="params">x, y, dx, dy</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Scrolled &#123;0&#125; at &#123;1&#125;&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">        <span class="string">&#x27;down&#x27;</span> <span class="keyword">if</span> dy &lt; <span class="number">0</span> <span class="keyword">else</span> <span class="string">&#x27;up&#x27;</span>,</span><br><span class="line">        (x, y)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 开始监听直到停止监听</span></span><br><span class="line"><span class="keyword">with</span> mouse.Listener(</span><br><span class="line">        on_move=on_move,</span><br><span class="line">        on_click=on_click,</span><br><span class="line">        on_scroll=on_scroll) <span class="keyword">as</span> listener:</span><br><span class="line">    listener.join()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 非阻塞式监听</span></span><br><span class="line">listener = mouse.Listener(</span><br><span class="line">    on_move=on_move,</span><br><span class="line">    on_click=on_click,</span><br><span class="line">    on_scroll=on_scroll)</span><br><span class="line">listener.start()</span><br><span class="line"><span class="comment"># input() 彩蛋</span></span><br><span class="line"><span class="comment"># 使用上面的非阻塞版本时，当前线程将继续执行。在与包含主循环的其他 GUI 框架集成时，这可能是必需的，但是当从脚本运行时，这将导致程序立即终止。</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>翻累了。。。<br>监听器</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">__init__(on_move=无，on_click=无，on_scroll=无，抑制=假，**kwargs)[来源]</span><br><span class="line">应始终使用关键字参数调用此构造函数。参数包括：</span><br><span class="line"></span><br><span class="line">组应为“无”;保留用于在实现线程组类时将来的扩展。</span><br><span class="line"></span><br><span class="line">目标是要由 run（） 方法调用的可调用对象。默认为“无”，表示不调用任何内容。</span><br><span class="line"></span><br><span class="line">名称是线程名称。默认情况下，唯一名称由“Thread-N”形式构造，其中 N 是一个小的十进制数。</span><br><span class="line"></span><br><span class="line">args 是目标调用的参数元组。默认值为 （）。</span><br><span class="line"></span><br><span class="line">kwargs 是目标调用的关键字参数的字典。默认值为 &#123;&#125;。</span><br><span class="line"></span><br><span class="line">如果子类重写了构造函数，则必须确保在对线程执行任何其他操作之前调用基类构造函数 （Thread.__init__（））。</span><br><span class="line"></span><br><span class="line">running</span><br><span class="line">侦听器当前是否正在运行。</span><br><span class="line"></span><br><span class="line">start()</span><br><span class="line">启动线程的活动。</span><br><span class="line"></span><br><span class="line">每个线程对象最多只能调用一次。它安排在单独的控制线程中调用对象的 run（） 方法。</span><br><span class="line"></span><br><span class="line">如果在同一线程对象上多次调用，则此方法将引发运行时错误。</span><br><span class="line"></span><br><span class="line">stop()</span><br><span class="line">停止侦听事件。</span><br><span class="line"></span><br><span class="line">此方法返回时，将不再传递任何事件。调用此方法后，侦听器实例将无法再使用，因为侦听器是 ，一旦停止，就无法重新启动。threading.Thread</span><br><span class="line"></span><br><span class="line">若要恢复对事件的侦听，必须创建新的侦听器。</span><br><span class="line"></span><br><span class="line">wait()</span><br><span class="line">等待此侦听器准备就绪。</span><br></pre></td></tr></table></figure><h4 id="控制键盘"><a href="#控制键盘" class="headerlink" title="控制键盘"></a>控制键盘</h4><p>像这样使用：pynput.keyboard.Controller</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pynput.keyboard <span class="keyword">import</span> Key, Controller</span><br><span class="line"></span><br><span class="line">keyboard = Controller()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 按下和松开space键</span></span><br><span class="line">keyboard.press(Key.space)</span><br><span class="line">keyboard.release(Key.space)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Type a lower case A; this will work even if no key on the</span></span><br><span class="line"><span class="comment"># physical keyboard is labelled &#x27;A&#x27;</span></span><br><span class="line">keyboard.press(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">keyboard.release(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Type two upper case As</span></span><br><span class="line">keyboard.press(<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">keyboard.release(<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line"><span class="keyword">with</span> keyboard.pressed(Key.shift):</span><br><span class="line">    keyboard.press(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">    keyboard.release(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Type &#x27;Hello World&#x27; using the shortcut type method</span></span><br><span class="line">keyboard.<span class="built_in">type</span>(<span class="string">&#x27;Hello World&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看按键</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">dir</span>(Key))</span><br></pre></td></tr></table></figure><h4 id="监听键盘"><a href="#监听键盘" class="headerlink" title="监听键盘"></a>监听键盘</h4><p>像这样使用：pynput.keyboard.Listener</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pynput <span class="keyword">import</span> keyboard</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">on_press</span>(<span class="params">key</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;alphanumeric key &#123;0&#125; pressed&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">            key.char))</span><br><span class="line">    <span class="keyword">except</span> AttributeError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;special key &#123;0&#125; pressed&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">            key))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">on_release</span>(<span class="params">key</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;&#123;0&#125; released&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">        key))</span><br><span class="line">    <span class="keyword">if</span> key == keyboard.Key.esc:</span><br><span class="line">        <span class="comment"># Stop listener</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Collect events until released</span></span><br><span class="line"><span class="keyword">with</span> keyboard.Listener(</span><br><span class="line">        on_press=on_press,</span><br><span class="line">        on_release=on_release) <span class="keyword">as</span> listener:</span><br><span class="line">    listener.join()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ...or, in a non-blocking fashion:</span></span><br><span class="line">listener = keyboard.Listener(</span><br><span class="line">    on_press=on_press,</span><br><span class="line">    on_release=on_release)</span><br><span class="line">listener.start()</span><br></pre></td></tr></table></figure><p>具体参考鼠标，这里不再翻译<br>官方文档还有很多有用的东西，这里不再赘述。比如tap(按下并释放一个键)。<br><a target="_blank" rel="noopener" href="https://pynput.readthedocs.io/en/latest/">官方文档</a></p><h3 id="Python控制剪切板"><a href="#Python控制剪切板" class="headerlink" title="Python控制剪切板"></a>Python控制剪切板</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pyperclip</span><br><span class="line"></span><br><span class="line"><span class="comment"># 复制文本</span></span><br><span class="line">pyperclip.copy(<span class="string">&#x27;The text to be copied to the clipboard.&#x27;</span>)</span><br><span class="line"><span class="comment"># 取剪贴板文本</span></span><br><span class="line">pyperclip.paste()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 此函数调用会一直阻塞，直到剪贴板上存在一个新的文本字符串，该字符串与首次调用该函数时的文本不同。它返回此文本。</span></span><br><span class="line">waitForNewPaste(timeout=<span class="literal">None</span>)</span><br><span class="line">此函数调用将阻塞，直到剪贴板上存在非空文本字符串。它返回此文本。</span><br><span class="line">waitForPaste(timeout=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure><p>实例<br>按下f7模拟鼠标左键单击</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pynput <span class="keyword">import</span> mouse</span><br><span class="line"><span class="keyword">from</span> pynput  <span class="keyword">import</span> keyboard</span><br><span class="line"><span class="keyword">from</span> pynput.keyboard <span class="keyword">import</span> Key</span><br><span class="line"><span class="keyword">from</span> pynput.mouse <span class="keyword">import</span> Button</span><br><span class="line"></span><br><span class="line">mousec = mouse.Controller()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">on_press</span>(<span class="params">key</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;alphanumeric key &#123;0&#125; pressed&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">            key.char))</span><br><span class="line">    <span class="keyword">except</span> AttributeError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;special key &#123;0&#125; pressed&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">            key))</span><br><span class="line">        <span class="keyword">if</span> key == Key.f7 :</span><br><span class="line">                mousec.press(Button.left)</span><br><span class="line">                mousec.release(Button.left)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> keyboard.Listener(</span><br><span class="line">        on_press=on_press) <span class="keyword">as</span> listener:</span><br><span class="line">    listener.join()</span><br><span class="line"></span><br></pre></td></tr></table></figure><br><div style="text-align:center">满分是10分的话，这篇文章你给几分，您的支持将鼓励我继续创作！</div><iframe src="https://jnuse.gitee.io/playing-reward/" style="overflow-x:hidden;overflow-y:hidden;border:0xp none #fff;min-height:240px;width:100%" frameborder="0" scrolling="no"></iframe><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者: </strong>聆听·彼岸</li><li class="post-copyright-link"><strong>本文链接: </strong><a href="https://ltba.github.io/20221023103610.html" title="Python操作键鼠与剪贴板">https://ltba.github.io/20221023103610.html</a></li><li class="post-copyright-license"><strong>版权声明: </strong>本站未注明转载的文章均为原创,所有文章除特别声明外,均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="external nofollow" target="_blank">CC BY-NC-SA 4.0</a> 许可协议.转载请注明出处!</li></ul><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/20221016150327.html" rel="next" title="想写点什么"><i class="fa fa-chevron-left"></i> 想写点什么</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"><a href="/20221115040748.html" rel="prev" title="新玩具">新玩具 <i class="fa fa-chevron-right"></i></a></div></div><aside id="directory"><div class="cl"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Python%E6%A8%A1%E6%8B%9F%E6%8C%89%E9%94%AE"><span class="toc-text">Python模拟按键</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AF%E4%BB%A5%E8%B0%83%E7%94%A8win32api%E6%9D%A5%E5%AE%9E%E7%8E%B0"><span class="toc-text">可以调用win32api来实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PyUserInput"><span class="toc-text">PyUserInput</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pynput"><span class="toc-text">Pynput</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A7%E5%88%B6%E9%BC%A0%E6%A0%87"><span class="toc-text">控制鼠标</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%91%E5%90%AC%E9%BC%A0%E6%A0%87"><span class="toc-text">监听鼠标</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%A7%E5%88%B6%E9%94%AE%E7%9B%98"><span class="toc-text">控制键盘</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%91%E5%90%AC%E9%94%AE%E7%9B%98"><span class="toc-text">监听键盘</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Python%E6%8E%A7%E5%88%B6%E5%89%AA%E5%88%87%E6%9D%BF"><span class="toc-text">Python控制剪切板</span></a></li></ol></li></ol></div></aside></div><div class="comments" id="comments"><div id="gitalk-container"></div></div></div></main><div class="footer"><div class="time"><span id="time"></span></div><div class="copyright">© 2019 <a target="_blank" rel="noopener" href="https://yked.gitee.io">聆听·彼岸</a>. All Rights Reserved. Theme By 《空》.</div></div><div class="back-to-top"></div><div id="TPlayer"></div><link rel="stylesheet" href="/css/gitalk.min.css"><script src="/js/gitalk.min.js"></script><script type="text/javascript">var gitalk=new Gitalk({clientID:"f57f0725ac5c431cb744",clientSecret:"e7b68dc9342d912a12cdc635ea0aa6e3c04ab3e9",repo:"comments",owner:"cai471600373",admin:["cai471600373"],id:location.pathname,distractionFreeMode:"true"});gitalk.render("gitalk-container")</script><script src="/js/riko.js"></script><script src="/music/player.js"></script>
        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(i){i.imageLazyLoadSetting.processImages=t;var o=i.imageLazyLoadSetting.isSPA,r=i.imageLazyLoadSetting.preloadRatio||1,a=c();function c(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(){o&&(a=c());for(var t,e,n=0;n<a.length;n++)t=a[n],e=void 0,0<=(e=t.getBoundingClientRect()).bottom&&0<=e.left&&e.top<=(i.innerHeight*r||document.documentElement.clientHeight*r)&&function(){var e=a[n];!function(t,e){if(t.hasAttribute("bg-lazy"))return t.removeAttribute("bg-lazy"),e&&e();var n=new Image,i=t.getAttribute("data-original");n.onload=function(){t.src=i,t.removeAttribute("data-original"),e&&e()},t.src!==i&&(n.src=i)}(e,function(){a=a.filter(function(t){return e!==t})})}()}function e(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",e),i.addEventListener("resize",e),i.addEventListener("orientationchange",e)}(this);</script></body></html>